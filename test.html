<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gravity Animation</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        width: 1920px;
        height: 1080px;
        overflow: hidden;
        background: #87ceeb;
        font-family: "Comic Sans MS", cursive, sans-serif;
      }
      #scene {
        width: 100%;
        height: 100%;
        position: relative;
      }
      #background {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        opacity: 1;
        transition: filter 1s;
      }
      #background img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      #grid-container {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        opacity: 0;
        pointer-events: none;
      }
      #grid {
        width: 100%;
        height: 100%;
        position: relative;
      }
      .grid-line {
        position: absolute;
        background: rgba(100, 200, 255, 0.6);
        box-shadow: 0 0 10px rgba(100, 200, 255, 0.8);
      }
      .grid-line.horizontal {
        width: 100%;
        height: 3px;
      }
      .grid-line.vertical {
        width: 3px;
        height: 100%;
      }
      #tree {
        position: absolute;
        left: 15%;
        bottom: 20%;
        width: 300px;
        height: 400px;
        opacity: 0;
      }
      .tree-trunk {
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 200px;
        background: #8b4513;
        border-radius: 10px;
      }
      .tree-foliage {
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 250px;
        height: 250px;
        background: #228b22;
        border-radius: 50%;
      }
      .tree-foliage::before,
      .tree-foliage::after {
        content: "";
        position: absolute;
        background: #228b22;
        border-radius: 50%;
      }
      .tree-foliage::before {
        width: 200px;
        height: 200px;
        top: -50px;
        left: -30px;
      }
      .tree-foliage::after {
        width: 200px;
        height: 200px;
        top: -50px;
        right: -30px;
      }
      #branch {
        position: absolute;
        top: 120px;
        left: 180px;
        width: 120px;
        height: 8px;
        background: #8b4513;
        border-radius: 4px;
        transform-origin: left center;
        transform: rotate(-10deg);
      }
      #apple-on-tree {
        position: absolute;
        top: 100px;
        left: 280px;
        width: 80px;
        height: 80px;
        opacity: 0;
      }
      #apple-on-tree img {
        width: 100%;
        height: 100%;
      }
      #kid {
        position: absolute;
        right: -200px;
        bottom: 20%;
        width: 200px;
        height: 300px;
        opacity: 0;
      }
      #kid img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      #falling-apple {
        position: absolute;
        width: 80px;
        height: 80px;
        opacity: 0;
        pointer-events: none;
      }
      #falling-apple img {
        width: 100%;
        height: 100%;
      }
      .arrow {
        position: absolute;
        width: 40px;
        height: 60px;
        opacity: 0;
      }
      .arrow::before {
        content: "";
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 6px;
        height: 45px;
        background: #ffd700;
        box-shadow: 0 0 10px #ffd700;
      }
      .arrow::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 15px solid transparent;
        border-right: 15px solid transparent;
        border-top: 20px solid #ffd700;
        filter: drop-shadow(0 0 10px #ffd700);
      }
      #text-overlay {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 80px;
        font-weight: bold;
        color: #ff6b6b;
        text-shadow: 4px 4px 0 #ffd93d, -2px -2px 0 #6bcb77, 2px -2px 0 #4d96ff,
          -2px 2px 0 #ff6b6b;
        opacity: 0;
        white-space: nowrap;
      }
      .sparkle {
        position: absolute;
        width: 30px;
        height: 30px;
        opacity: 0;
      }
      .sparkle::before,
      .sparkle::after {
        content: "";
        position: absolute;
        background: #ffd700;
      }
      .sparkle::before {
        width: 100%;
        height: 4px;
        top: 50%;
        left: 0;
        transform: translateY(-50%);
        box-shadow: 0 0 10px #ffd700;
      }
      .sparkle::after {
        width: 4px;
        height: 100%;
        left: 50%;
        top: 0;
        transform: translateX(-50%);
        box-shadow: 0 0 10px #ffd700;
      }
    </style>
  </head>
  <body>
    <div id="scene">
      <!-- <div id="background">
        <img
          src="https://assets-orcin-eight.vercel.app/assets/backgrounds/park.svg"
          alt="park"
        />
      </div> -->
      <div id="grid-container">
        <div id="grid"></div>
      </div>
      <div id="tree">
        <div class="tree-trunk"></div>
        <div class="tree-foliage"></div>
        <div id="branch"></div>
        <div id="apple-on-tree">
          <img
            src="https://assets-orcin-eight.vercel.app/assets/objects/apple.svg"
            alt="apple"
          />
        </div>
      </div>
      <div id="kid">
        <img
          src="https://assets-orcin-eight.vercel.app/assets/characters/walking-boy.svg"
          alt="kid"
        />
      </div>
      <div id="falling-apple">
        <img
          src="https://assets-orcin-eight.vercel.app/assets/objects/apple.svg"
          alt="apple"
        />
      </div>
      <div id="text-overlay">Gravity pulls everything down!</div>
    </div>
    <script>
      const scene = document.getElementById("scene");
      const background = document.getElementById("background");
      const gridContainer = document.getElementById("grid-container");
      const grid = document.getElementById("grid");
      const tree = document.getElementById("tree");
      const appleOnTree = document.getElementById("apple-on-tree");
      const kid = document.getElementById("kid");
      const kidImg = kid.querySelector("img");
      const fallingApple = document.getElementById("falling-apple");
      const textOverlay = document.getElementById("text-overlay");

      for (let i = 0; i <= 10; i++) {
        const line = document.createElement("div");
        line.className = "grid-line horizontal";
        line.style.top = i * 10 + "%";
        grid.appendChild(line);
      }

      for (let i = 0; i <= 10; i++) {
        const line = document.createElement("div");
        line.className = "grid-line vertical";
        line.style.left = i * 10 + "%";
        grid.appendChild(line);
      }

      function createArrow(parent, x, y) {
        const arrow = document.createElement("div");
        arrow.className = "arrow";
        arrow.style.left = x + "px";
        arrow.style.top = y + "px";
        parent.appendChild(arrow);
        return arrow;
      }

      function animateElement(element, props, duration, easing = "ease") {
        return new Promise((resolve) => {
          const startProps = {};
          for (let prop in props) {
            startProps[prop] = getComputedStyle(element)[prop];
          }
          element.style.transition = `all ${duration}ms ${easing}`;
          for (let prop in props) {
            element.style[prop] = props[prop];
          }
          setTimeout(() => {
            element.style.transition = "";
            resolve();
          }, duration);
        });
      }

      function wait(ms) {
        return new Promise((resolve) => setTimeout(resolve, ms));
      }

      async function runAnimation() {
        await animateElement(tree, { opacity: "1" }, 500);
        await wait(300);
        await animateElement(
          kid,
          { right: "25%", opacity: "1" },
          2000,
          "ease-out"
        );
        await wait(500);

        kidImg.src =
          "https://assets-orcin-eight.vercel.app/assets/characters/smiling-boy.svg";
        await wait(300);

        kid.style.transform = "scale(1.3)";
        kid.style.transformOrigin = "center center";
        kid.style.transition = "transform 800ms ease";
        await wait(800);
        kid.style.transition = "";

        await wait(500);
        await animateElement(appleOnTree, { opacity: "1" }, 300);
        await wait(700);

        background.style.filter = "brightness(0.7)";
        await animateElement(gridContainer, { opacity: "1" }, 1000);

        const gridLines = grid.querySelectorAll(".grid-line");
        gridLines.forEach((line, idx) => {
          if (line.classList.contains("horizontal")) {
            const top = parseInt(line.style.top);
            if (top > 50) {
              const curve = (top - 50) * 0.3;
              line.style.transform = `translateY(${curve}px)`;
              line.style.transition = "transform 1s ease";
            }
          }
        });

        await wait(1200);

        const appleArrows = [];
        for (let i = 0; i < 4; i++) {
          const angle = (i * Math.PI * 2) / 4;
          const x = 30 + Math.cos(angle) * 50;
          const y = 30 + Math.sin(angle) * 50;
          const arrow = createArrow(appleOnTree, x, y);
          appleArrows.push(arrow);
        }

        // Animate arrows around apple
        for (let arrow of appleArrows) {
          await animateElement(arrow, { opacity: "1" }, 300);
          await wait(100);
        }

        // Blink the apple arrows 3x
        for (let i = 0; i < 3; i++) {
          for (let arrow of appleArrows) {
            arrow.style.opacity = "0.3";
          }
          await wait(300);
          for (let arrow of appleArrows) {
            arrow.style.opacity = "1";
          }
          await wait(300);
        }

        await wait(500);

        // Wiggle animation for the apple
        if (!document.getElementById("wiggle-keyframes")) {
          const wiggleKeyframes = document.createElement("style");
          wiggleKeyframes.id = "wiggle-keyframes";
          wiggleKeyframes.textContent = `
          @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
          }
        `;
          document.head.appendChild(wiggleKeyframes);
        }
        appleOnTree.style.animation = "wiggle 0.3s ease-in-out 2";
        await wait(600);
        appleOnTree.style.opacity = "0";
        appleArrows.forEach((arrow) => (arrow.style.opacity = "0"));

        // Position and drop the falling apple
        const appleRect = appleOnTree.getBoundingClientRect();
        fallingApple.style.left = appleRect.left + "px";
        fallingApple.style.top = appleRect.top + "px";
        fallingApple.style.opacity = "1";

        const fallDistance = window.innerHeight - appleRect.top - 250;
        const fallDuration = 1500;

        fallingApple.style.transition = `top ${fallDuration}ms cubic-bezier(0.5, 0, 1, 1)`;
        fallingApple.style.filter =
          "drop-shadow(0 10px 20px rgba(255, 100, 100, 0.6))";
        fallingApple.style.top = appleRect.top + fallDistance + "px";

        await wait(fallDuration / 2);

        kid.style.transform = "scale(1)";
        kid.style.transition = "transform 500ms ease";
        await wait(500);

        // Create kid arrows
        const kidArrows = [];
        const kidRect = kid.getBoundingClientRect();
        for (let i = 0; i < 4; i++) {
          const angle = (i * Math.PI * 2) / 4;
          const x = 100 + Math.cos(angle) * 80;
          const y = 150 + Math.sin(angle) * 80;
          const arrow = createArrow(kid, x, y);
          kidArrows.push(arrow);
        }

        for (let arrow of kidArrows) {
          await animateElement(arrow, { opacity: "1" }, 200);
        }

        kidImg.src =
          "https://assets-orcin-eight.vercel.app/assets/characters/excited-boy.svg";
        kid.style.transition = "bottom 300ms ease-out";
        kid.style.bottom = "25%";
        await wait(300);
        kid.style.transition = "bottom 400ms ease-in";
        kid.style.bottom = "20%";
        await wait(400);

        await wait(200);

        // Ripple effect on grid lines (horizontal)
        const gridLinesForRipple = grid.querySelectorAll(
          ".grid-line.horizontal"
        );
        gridLinesForRipple.forEach((line, idx) => {
          const top = parseInt(line.style.top);
          if (top > 70) {
            setTimeout(() => {
              line.style.transform =
                "translateY(" + ((top - 50) * 0.3 + 20) + "px)";
              line.style.transition = "transform 300ms ease-out";
              setTimeout(() => {
                line.style.transform = "translateY(" + (top - 50) * 0.3 + "px)";
                line.style.transition = "transform 300ms ease-in";
              }, 300);
            }, idx * 20);
          }
        });

        fallingApple.style.transition = "transform 200ms ease-out";
        fallingApple.style.transform = "translateY(-30px)";
        await wait(200);
        fallingApple.style.transition = "transform 150ms ease-in";
        fallingApple.style.transform = "translateY(0)";
        await wait(150);

        const boopSound = new Audio();
        boopSound.src =
          "data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=";
        boopSound.play().catch(() => {});

        await wait(500);

        kidImg.src =
          "https://assets-orcin-eight.vercel.app/assets/characters/smiling-boy.svg";
        kidArrows.forEach((arrow) => (arrow.style.opacity = "0"));

        await wait(300);

        await animateElement(textOverlay, { opacity: "1" }, 800);

        await wait(1500);

        background.style.filter = "brightness(1)";
        await animateElement(gridContainer, { opacity: "0" }, 800);

        kidImg.src =
          "https://assets-orcin-eight.vercel.app/assets/characters/laughing-boy.svg";

        const sparkle = document.createElement("div");
        sparkle.className = "sparkle";
        const applePos = fallingApple.getBoundingClientRect();
        sparkle.style.left = applePos.left + 40 + "px";
        sparkle.style.top = applePos.top - 40 + "px";
        scene.appendChild(sparkle);

        sparkle.style.transition = "opacity 400ms ease-in-out";
        sparkle.style.opacity = "1";
        await wait(400);
        sparkle.style.opacity = "0";

        await wait(2000);
      }

      runAnimation();
    </script>
  </body>
</html>
